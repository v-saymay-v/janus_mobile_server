$(window).on("load", function(){$.extend(RecurrenceTools,{limitToMaxValue:function(e,d){var f=$("#"+e).val();if(f!=""&&f!=undefined&&f!=null){if(parseInt(f)<=d){RecurrenceTools.resetEndDate();/*RecurrenceTools.saveRecurrenceSettings()*/}}},resetMaxIntervals:function(){if(recurrenceTypeVue.dailyInterval>90){recurrenceTypeVue.dailyInterval=90;$(".interval-error").hide()}if(recurrenceTypeVue.weeklyInterval>12){recurrenceTypeVue.weeklyInterval=12;$(".interval-error").hide()}if(recurrenceTypeVue.monthlyInterval>3){recurrenceTypeVue.monthlyInterval=3;$(".interval-error").hide()}if(recurrenceTypeVue.endTimes>50){recurrenceTypeVue.endTimes=50;$(".times-error").hide()}},isLeapYear:function(d){return(((d%4===0)&&(d%100!==0))||(d%400===0))},getDaysInMonth:function(d,e){return[31,(RecurrenceTools.isLeapYear(d)?29:28),31,30,31,30,31,31,30,31,30,31][e]},addMonths:function(e,f){var g=parseDateByCookies(e);var h=g.getDate();g.setDate(1);g.setMonth(g.getMonth()+f);g.setDate(Math.min(h,RecurrenceTools.getDaysInMonth(g.getFullYear(),g.getMonth())));return g},resetEndDate:function(){var j=recurrenceTypeVue.recurrenceType;var e=$("#start_date").val();var i=new Date();var h=new Date();var g=1;if(j==="DAILY"){g=recurrenceTypeVue.dailyInterval;h=new Date(parseDateByCookies(e).getTime()+86400000*50*g);i=new Date(parseDateByCookies(e).getTime()+86400000*6*g);$("#endDate").datepicker("option","maxDate",h);$("#endDate").datepicker("setDate",i);$("#endDate").datepickeracc()}else{if(j==="WEEKLY"){g=recurrenceTypeVue.weeklyInterval;h=new Date(parseDateByCookies(e).getTime()+86400000*50*7*g);i=new Date(parseDateByCookies(e).getTime()+86400000*7*6*g);$("#endDate").datepicker("option","maxDate",h);$("#endDate").datepicker("setDate",i);$("#endDate").datepickeracc();var f=parseDateByCookies(e).getDay()+1;$("input[type='checkbox'][name='weeklyWeekDays'][value="+f+"]").prop("checked",true)}else{if(j==="MONTHLY"){g=recurrenceTypeVue.monthlyInterval;h=RecurrenceTools.addMonths(e,g*50);i=RecurrenceTools.addMonths(e,g*6);$("#endDate").datepicker("option","maxDate",h);$("#endDate").datepicker("setDate",i);$("#endDate").datepickeracc();var d=parseDateByCookies(e).getDate();$("#monthlyByDay").val(d).trigger("change")}}}},recurrenceTypeChanged:function(e){var d=recurrenceTypeVue.recurrenceType;if(d==="DAILY"){$(".daily").removeClass("hideme");$(".weekly").addClass("hideme");$(".monthly").addClass("hideme");$(".classic").addClass("hideme");$(".custom").addClass("hideme");$(".notclassic").removeClass("hideme");RecurrenceTools.showRegistrationRow(true);RecurrenceTools.showPublicCalendarSection(true)}else{if(d==="WEEKLY"){$(".daily").addClass("hideme");$(".weekly").removeClass("hideme");$(".monthly").addClass("hideme");$(".classic").addClass("hideme");$(".custom").addClass("hideme");$(".notclassic").removeClass("hideme");RecurrenceTools.showRegistrationRow(true);RecurrenceTools.showPublicCalendarSection(true)}else{if(d==="MONTHLY"){$(".daily").addClass("hideme");$(".weekly").addClass("hideme");$(".monthly").removeClass("hideme");$(".classic").addClass("hideme");$(".custom").addClass("hideme");$(".notclassic").removeClass("hideme");RecurrenceTools.showRegistrationRow(true);RecurrenceTools.showPublicCalendarSection(true)}else{if(d==="CLASSIC"){$(".daily").addClass("hideme");$(".weekly").addClass("hideme");$(".monthly").addClass("hideme");$(".classic").removeClass("hideme");$(".custom").addClass("hideme");$(".notclassic").addClass("hideme");RecurrenceTools.showRegistrationRow(false);RecurrenceTools.showPublicCalendarSection(false)}else{if(d==="CUSTOM"){$(".daily").addClass("hideme");$(".weekly").addClass("hideme");$(".monthly").addClass("hideme");$(".classic").addClass("hideme");$(".custom").removeClass("hideme");$(".notclassic").addClass("hideme");RecurrenceTools.showPublicCalendarSection(true)}}}}}RecurrenceTools.resetEndDate();if(e){/*RecurrenceTools.saveRecurrenceSettings()*/}RecurrenceTools.resetMaxIntervals();meetings.showJbhPriorStartMeeting()},showRegistrationRow:function(d){if(d){$("#isShowRegistration").removeClass("hideme")}else{$("#option_registration").prop("checked",false);$("#isShowRegistration").addClass("hideme")}},getStartTime:function(d){var f=$.cookie("_zm_date_format");var e=$("#start_time").val();if($("#start_time_2").length>0){e=RecurrenceTools.changeTo24Hours($("#start_time").val(),ampmVue.val)}d.startTime=convertDateFotmat($("#start_date").val(),f,"mm/dd/yy")+" "+e},getEndTime:function(d){var g=$("input[name='endBy']:checked").val();d.endType=g;if(g=="END_DATETIME"){var f=$.cookie("_zm_date_format");var e=convertDateFotmat($("#endDate").val(),f,"mm/dd/yy");d.endTime=e+" 23:59"}else{if(g=="END_TIMES"){d.times=Math.min(50,recurrenceTypeVue.endTimes);if(recurrenceTypeVue.endTimes>50){recurrenceTypeVue.endTimes=50}}}},getDaily:function(d){var f=[];var e={type:"INTERVAL",value:recurrenceTypeVue.dailyInterval};f.push(e);d.recurrenceValues=f},getWeekly:function(d){var g=[];var e={type:"INTERVAL",value:recurrenceTypeVue.weeklyInterval};g.push(e);var h="";$("#recurrenceDialog").find("input[name='weeklyWeekDays']").each(function(){var i=$(this);if(i.prop("checked")){h=h+","+i.val()}});var f={type:"BYDAY",value:h.substring(1)};g.push(f);d.recurrenceValues=g},getMonthly:function(d){var f=[];var e={type:"INTERVAL",value:recurrenceTypeVue.monthlyInterval};f.push(e);var g=$("input[name='monthlyBy']:checked").val();if(g==="BYMONTHDAY"){f.push({type:"BYMONTHDAY",value:recurrenceTypeVue.monthlyByDay})}else{f.push({type:"BYDAY",value:recurrenceTypeVue.montlyByWeekday});f.push({type:"BYSETPOS",value:recurrenceTypeVue.montlyByWeekdayIndex})}d.recurrenceValues=f},changeTo24Hours:function(d,g){if(g==="AM"){var f=d.split(":");var e=parseInt(f[0]);if(e<10){return"0"+e+":"+f[1]}else{if(e==12){return"00:"+f[1]}}return d}else{if(d.indexOf("12:")==0){return d}else{var f=d.split(":");var e=12+parseInt(f[0]);return e+":"+f[1]}}},isValidEndTime:function(){var f=$("input[name='endBy']:checked").val();if(f=="END_DATETIME"){var e=parseDateByCookies($("#endDate").val());var d=parseDateByCookies($("#start_date").val());if(e.getTime()<=d.getTime()){return false}}else{if(f=="END_TIMES"){return true}}return true},isValidWeekDays:function(){var d="";$("#recurrenceDialog").find("input[name='weeklyWeekDays']").each(function(){var e=$(this);if(e.prop("checked")){d=d+","+e.val()}});if(d.length<=1){return false}return true},saveRecurrenceSettings:function(){var e=$("#option_rm").prop("checked");if(!e){return}if(!RecurrenceTools.isValidEndTime()){RecurrenceTools.resetEndDate()}var g=recurrenceTypeVue.recurrenceType;var f=timezone_vue.val;var d={type:g,timezone:f};if(g==="DAILY"){if(!RecurrenceTools.isValidEndTime()){$("#endDate").focus();return}RecurrenceTools.getStartTime(d);RecurrenceTools.getDaily(d);RecurrenceTools.getEndTime(d)}else{if(g==="WEEKLY"){if(!RecurrenceTools.isValidEndTime()){$("#endDate").focus();return}if(!RecurrenceTools.isValidWeekDays()){$("input[name='weeklyWeekDays']").get(0).focus();return}RecurrenceTools.getStartTime(d);RecurrenceTools.getWeekly(d);RecurrenceTools.getEndTime(d)}else{if(g==="MONTHLY"){if(!RecurrenceTools.isValidEndTime()){$("#endDate").focus();return}RecurrenceTools.getStartTime(d);RecurrenceTools.getMonthly(d);RecurrenceTools.getEndTime(d)}}}SB.post3({url:"/meeting/checkRecurrence",data:{recurrence:JSON.stringify(d)},success:function(h){$("#recurrence").val(JSON.stringify(d));RecurrenceTools.changeAndDisableStartTime(h);$("#recurrenceDialog").find(".alert-danger").hide()},errorNode:$("#recurrenceDialog").find(".alert-danger")})},initRecurrenceDialogDefaultValue:function(){var d=$("#recurrence").val();if(d===""){RecurrenceTools.resetEndDate()}},showRecurrenceDialog:function(d){if(d){$("#recurrenceDialog").removeClass("hideme");$(".input-datepicker").next("button").attr("aria-label","Date picker "+$.i18n.get("meeting.choose_another_date"))}else{$("#recurrenceDialog").addClass("hideme")}},loadRecurrenceSettings:function(){if($("#recurrence").attr("data-s")===undefined||$("#recurrence").attr("data-s")===""||$("#recurrence").attr("data-s")==="null"){return}var l=JSON.parse($("#recurrence").attr("data-s"));RecurrenceTools.initRecurrenceDialogDefaultValue();recurrenceTypeVue.recurrenceType=l.type;RecurrenceTools.recurrenceTypeChanged(false);if(l.type==="CLASSIC"){return}var e=l.startTime;var f=new Date(e);$("#start_date").datepicker("setDate",f);var j=RecurrenceTools.getValueByName(l.recurrenceValues,"INTERVAL");if(l.type==="DAILY"){recurrenceTypeVue.dailyInterval=j;RecurrenceTools.resetEndDate()}if(l.type==="WEEKLY"){recurrenceTypeVue.weeklyInterval=j;RecurrenceTools.resetEndDate();var k=RecurrenceTools.getValueByName(l.recurrenceValues,"BYDAY");$("input[name='weeklyWeekDays']").each(function(m){if(k.indexOf($(this).val())>=0){$(this).prop("checked",true)}})}if(l.type==="MONTHLY"){recurrenceTypeVue.monthlyInterval=j;RecurrenceTools.resetEndDate();var h=RecurrenceTools.getValueByName(l.recurrenceValues,"BYMONTHDAY");if(h!=""){$($("input[type=radio][name=monthlyBy]")[0]).prop("checked",true);recurrenceTypeVue.monthlyByDay=h}else{$($("input[type=radio][name=monthlyBy]")[1]).prop("checked",true);var g=RecurrenceTools.getValueByName(l.recurrenceValues,"BYSETPOS");recurrenceTypeVue.montlyByWeekdayIndex=g;var d=RecurrenceTools.getValueByName(l.recurrenceValues,"BYDAY");recurrenceTypeVue.montlyByWeekday=d}RecurrenceTools.resetEndDate()}if(l.endType==="END_TIMES"){$($("input[type=radio][name=endBy]")[1]).prop("checked",true);recurrenceTypeVue.endTimes=l.times}else{$($("input[type=radio][name=endBy]")[0]).prop("checked",true);var i=new Date(l.endTime);$("#endDate").datepicker("setDate",i)}if(!RecurrenceTools.isValidEndTime()){RecurrenceTools.resetEndDate()}/*RecurrenceTools.saveRecurrenceSettings()*/},getValueByName:function(f,g){for(var e=0;e<f.length;e++){var d=f[e];if(d.type===g){return d.value}}return""},showUsePMI:function(d){if(d){if(!disablePMI){$("#withPMI").removeClass("hideme")}meetings.setScheduleWithPMI(b);if(c()){$("#option_registration").prop("checked",false).trigger("change")}}else{$("#withPMI").addClass("hideme");meetings.chooseMeetingId(false);$(".register-tip-disable").addClass("hideme")}},showMeetingDateAndTime:function(d){if(d){$("#mt_time").show()}else{$("#mt_time").hide()}},hasOldRecurrenceSetting:function(){if($("#recurrence").attr("data-s")===undefined||$("#recurrence").attr("data-s")===""||$("#recurrence").attr("data-s")==="null"){return false}else{return true}},showRegistrationOptions:function(d){if(d){$(".registrationRequiredType").removeClass("hideme")}else{$(".registrationRequiredType").addClass("hideme")}},changeAndDisableStartTime:function(d){var e=$("#option_registration").prop("checked");var f=recurrenceTypeVue.recurrenceType;if(f==="CLASSIC"){RecurrenceTools.showMeetingDateAndTime(false);RecurrenceTools.showRegistrationOptions(false);RecurrenceTools.showUsePMI(true);$("#recurrence_desc").html("");RecurrenceTools.checkClassicUsePMI()}else{RecurrenceTools.showMeetingDateAndTime(true);RecurrenceTools.showRegistrationOptions(e);RecurrenceTools.showUsePMI(false);$("#recurrence_desc").html(d.result)}$("#option_rm").prop("checked",true);RecurrenceTools.showRecurrenceDesc(true);if(e&&f!="CLASSIC"){if($("input[name='registrationRequiredType']:checked").length<=0){$($("input[name='registrationRequiredType']").get(0)).prop("checked",true)}}},checkClassicUsePMI:function(){var d=$("#withPMIOption").val();if(d=="true"){meetings.chooseMeetingId(true)}else{meetings.chooseMeetingId(false)}},showRecurrenceDesc:function(d){if($("#recurrence_desc").length>0){if(d){if($("#recurrence").val()!=""){$(".recurrence_desc").removeClass("hideme")}}else{$(".recurrence_desc").addClass("hideme")}}},isOldMeeting:function(){var d=$("#meeting_number").val();return parseInt(d)>0},showPublicCalendarSection:function(d){var e=$(".public-calendar-section");if(e.length==0){return}else{if(d){e.show()}else{e.hide();e.find("#option_public_calender_meeting").prop("checked",false)}}}});$("#dailyIntervalComboBox").on("click",function(d){d.preventDefault();d.stopPropagation()});$("#weeklyIntervalCombobox").on("click",function(d){d.preventDefault();d.stopPropagation()});$("#monthlyIntervalCombobox").on("click",function(d){d.preventDefault();d.stopPropagation()});$("#endTimesCombobox").on("click",function(d){d.preventDefault();d.stopPropagation()});new ComboBox("dailyInterval",{onChange:function(){RecurrenceTools.limitToMaxValue("dailyInterval",90)}});new ComboBox("weeklyInterval",{onChange:function(){RecurrenceTools.limitToMaxValue("weeklyInterval",12)}});new ComboBox("monthlyInterval",{onChange:function(){RecurrenceTools.limitToMaxValue("monthlyInterval",3)}});new ComboBox("endTimes",{onChange:function(){/*RecurrenceTools.saveRecurrenceSettings()*/}});$("#option_rm").on("change",function(g){var f=$("#option_registration").prop("checked");var i=recurrenceTypeVue.recurrenceType;recurrenceTypeVue.monthlyByDay=parseDateByCookies($("#start_date").val()).getDate();var h=false;var d=$(this);if(d.prop("checked")){h=true}else{RecurrenceTools.showRegistrationOptions(false);RecurrenceTools.showRecurrenceDialog(false);RecurrenceTools.resetMaxIntervals()}if(h){if($("#recurrence").val()!=""){RecurrenceTools.showRegistrationOptions(h&&f);RecurrenceTools.showRecurrenceDesc(true)}RecurrenceTools.initRecurrenceDialogDefaultValue();RecurrenceTools.showRecurrenceDialog(true);if(i==="CLASSIC"){RecurrenceTools.showRegistrationRow(false);RecurrenceTools.showPublicCalendarSection(false)}}else{RecurrenceTools.showRegistrationRow(true);RecurrenceTools.showMeetingDateAndTime(true);RecurrenceTools.showUsePMI(true);RecurrenceTools.showRecurrenceDesc(false);RecurrenceTools.showPublicCalendarSection(true);meetings.showJbhPriorStartMeeting()}/*RecurrenceTools.saveRecurrenceSettings();*/return});var b=meetings.getUserSettingOptions();function a(){var d=b;if(typeof d!="undefined"){return typeof d.usePMISchedule!="undefined"&&d.usePMISchedule=="true"&&typeof d.usePMISchedule_locked!="undefined"&&d.usePMISchedule_locked=="true"}return false}function c(){if($("#withPMI").length>0&&$("#withPMI").is(":visible")){return a()}return false}$("#option_registration").on("change",function(g){var d=$(this);if(c()){d.prop("checked",false);$(".register-tip-disable").removeClass("hideme")}else{$(".register-tip-disable").addClass("hideme")}var h=false;if(d.prop("checked")){h=true}else{RecurrenceTools.showRegistrationOptions(false)}if(h){meetings.chooseMeetingId(false);if($("input[name='registrationRequiredType']:checked").length<=0){$($("input[name='registrationRequiredType']").get(0)).prop("checked",true)}if($("#recurrence").val()===""){RecurrenceTools.showRegistrationOptions(false)}else{var f=JSON.parse($("#recurrence").val());if($("#option_rm").prop("checked")&&f.type!="CLASSIC"){RecurrenceTools.showRegistrationOptions(true)}else{RecurrenceTools.showRegistrationOptions(false)}}}else{RecurrenceTools.showRegistrationOptions(false)}});$("input[name=option_schedulewithpmi]").on("change",function(f){var d=$(this);if(d.prop("checked")&&d.val()=="on"){$("#option_registration").prop("checked",false)}});if($("#m_classicRecurrence").val()==="on"){$("input[name='registrationRequiredType']").removeAttr("disabled");RecurrenceTools.showMeetingDateAndTime(false);RecurrenceTools.showUsePMI(true);$("#option_rm").prop("checked",true);RecurrenceTools.showRecurrenceDialog(true);RecurrenceTools.initRecurrenceDialogDefaultValue();recurrenceTypeVue.recurrenceType="CLASSIC";RecurrenceTools.recurrenceTypeChanged(true);RecurrenceTools.checkClassicUsePMI()}else{RecurrenceTools.showMeetingDateAndTime(true)}if($("#m_newRecurrence").val()==="on"){RecurrenceTools.showMeetingDateAndTime(true);RecurrenceTools.showUsePMI(false);$("#option_rm").prop("checked",true);if($("#responseToSingleOccurrence").val()==="false"){RecurrenceTools.showRecurrenceDialog(true)}meetings.chooseMeetingId(false);RecurrenceTools.loadRecurrenceSettings();if($("#responseToSingleOccurrence").val()==="true"){$("#start_date").datepicker("setDate",$("#m_start_date").val());$("#duration_hr").val($("#m_duration_hr").val());$("#duration_min").val($("#m_duration_min").val())}}$("#endDate").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/});$("#monthlyByDay").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/});$("#montlyByWeekdayIndex").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/});$("#montlyByWeekday").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/});$("input[type='checkbox'][name='weeklyWeekDays']").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/});$("input[name='endBy']").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/});$("input[name='monthlyBy']").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/});$("#start_date").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/});$("#timezone").on("change",function(d){/*RecurrenceTools.saveRecurrenceSettings()*/})});